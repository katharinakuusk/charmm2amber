#gmx_lipid17.ff:
a gromacs port of the amber lipid force field LIPID17
==============================================================

This is an gromacs port of the amber LIPID17 force field. The amber to gromacs
format conversion is first done with ParmEd (https://github.com/ParmEd/ParmEd).
I have written a script to condense all the bonded interaction into a force field
format, provide the corresponding gro file for every lipids, and validate the
energy to make sure the gromacs port yeild the same energy as the original amber
format.

# Usage

To use the lipids in the LIPID17, one has to first find out the name of the
desired lipid. Since LIPID17 is a modular force field, the name of the lipid
is composed of the two Acyl chains and the head group in the format of
{Acyl_chain_A}_{head_group}_{Acyl_chain_B}. The available descriptions are:

|            | Description              | Residue Name |
|------------|--------------------------|--------------|
| Acyl chain | Lauroyl (12:0)           | LAL          |
|            | Myristoyl (14:0)         | MY           |
|            | Palmitoyl (16:0)         | PA           |
|            | Oleoyl (18:1 n-9)        | OL           |
|            | Stearoyl (18:0)          | ST           |
|            | Arachidonoyl (20:4)      | AR           |
|            | Docosahexaenoyl (22:6)   | DHA          |
| Head group | Phosphatidylcholine      | PC           |
|            | Phosphatidylethanolamine | PE           |
|            | Phosphatidylserine       | PS           |
|            | Phosphatidylglycerol     | PGR          |
|            | Phosphaditic acid        | PH-          |
| Other      | Cholesterol              | CHL          |

The popular POPC lipid will have a name of PA_PC_OL, whereas Cholesterol will
have a name of CHL. For the lipid where the two Acyl chains are the same such
as DMPC, the name of the lipid is MY_PC_MY.

After the name is found, one can add the corresponding molecule to the gromacs
topology file, after the force filed `lipid17.ff` and the itp file
`lipid17.itp` is included. Sample topol.top for POPC lipid will look like this.

```
#include "lipid17.ff/forcefield.itp"

#include "lipid17.itp"

[ system ]
; Name
Lipid

[ molecules ]
; Compound        #mols
PA_PC_OL               1
```

The gro file for each lipid can be found in the `gro` folder. for lipid POPC,
the gro file has a name of `PA_PC_OL.gro`.

# Procedure of force field generation
## Lipid generation
The amber lipid is generation using tleap in folder `generation`. The tleap
input file is generated with `amber_input.py`

```bash
cd generation
python amber_input.py
tleap -f tleap.in > tleap.out
```

After the successful generation of all the lipids in amber format, the files are
converted to gromacs topology and coordinate file with ParmEd.

```bash
python parmed_conversion.py
```

## Force field generation
The gromacs topology generated by ParmEd are then condensed into a compact
force field, where bonds are condensed to bondtypes, so does the angles and
dihedrals. This step is done in the folder `conversion`.

```bash
cd ../conversion
python main.py
```

## Force field validation
The validation of the generated force field is tested against the original amber
implementation in the folder `validation`.

```bash
cd ../validation
python validate.py
```

The log of the energy difference is recorded in `validation/energy_difference.log`.
Though the total potential may vary for a bit for some lipids due to the different
implementation of the non-bonded interactions, the bond, angle, dihedral
potential are all very close (< 0.1 kcal/mol).
